<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>ConfigMgr - Onedrive Status</title>
  <meta name="description" content="beanska.github.io">
  <meta name="author" content="beanska">
  <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.1/build/pure-min.css" integrity="sha384-oAOxQR6DkCoMliIh8yFnu25d7Eq/PHS21PClpwjOTeU2jRSq11vu66rf90/cZr47" crossorigin="anonymous">
  <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.1/build/grids-responsive-min.css">
  <link rel="stylesheet" href="../main.css">

</head>

<body>
  <div id="layout" class="pure-g">

    <div class="content pure-u-1 pure-u-md-3-4">
      <h2>ConfigMgr - Onedrive Status</h2>
      <p>At this time Microsoft still hasn't created a centralized method to review the Onedrive status for your users. To that end <a href="https://github.com/rodneyviana/ODSyncService">Rodney Viana created a DLL that will give us the status of Onedrive.</a> Below is how I utilize it in ConfigMgr. </p>
      <h3>1) Create the application to distribute the package</h3>
      <p>This purpose of this application is to copy the DLL files to each computer.</p>
      <h4>a) Downloading the files.</h4>
      <p> In the folder that you will use as the source for the application, download the below files. After downloading make sure you unblock the files. 
          <ul>
              <li><a href="https://github.com/rodneyviana/ODSyncService/raw/master/Binaries/PowerShell/OneDriveLib.dll">https://github.com/rodneyviana/ODSyncService/raw/master/Binaries/PowerShell/OneDriveLib.dll</a></li>
              <li><a href=https://github.com/rodneyviana/ODSyncService/raw/master/DebugAndTraces/OneDriveLib.dll>https://github.com/rodneyviana/ODSyncService/raw/master/DebugAndTraces/OneDriveLib.dll</a> &lt;--Rename this to OneDriveLibDebug.dll</li>
              <li><a href="./install.bat">Install.bat</a></li>
          </ul>
          <img src=".\1_1.png">
      </p>
      <h4>b) Creating the application.</h4>
      <p>Deploy this application to all workstations. You want the user experience to hide this is Software center.</p>
        <img src=".\1_2.png"><br>
        <img src=".\1_3.png"><br>
        <img src=".\1_4.png"><br>
        <img src=".\1_5.png"><br>
        
      </p>
      <h3>2) Create a configuration item to return the status.</h3>
      <p><img src=".\2_2.png"></p>
      <p><img src=".\2_3.png"> </p>
      <p><a href=".\ODFBCompliance.ps1">HERE</a> is the script for compliance. </p>
      <p><img src=".\2_4.png"> </p>
      <p><img src=".\2_5.png"> </p>
      <p><img src=".\2_6.png"> </p>
      <p>Put the Configuration Item into and Configuration Baseline and deploy to a collection of <b>USERS</b> at whatever interval you deem appropriate.</p>
      <h3>Reporting</h3>
      <p>For me I am interested in the users that are not able to sync. I use <a href=".\ODFBNonCompliant.sql">this SQL</a> to find those that are having issues. Users the return Non-Compliant:</p>
  

    </div>
  </div>
</body>
</html>
